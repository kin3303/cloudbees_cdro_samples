<?xml version="1.0" encoding="UTF-8"?>
<exportedData version="96" buildLabel="build_main_142654_2020.06.25_02:11:48" buildVersion="10.0.0.142654" passkey="b734f8f6603c3a6ac13414c5b07fbf1a6583446a">
  <exportPath>/projects/CO_SIMPLE_ROLLBACK_APP</exportPath>
  <project>
    <projectName>CO_SIMPLE_ROLLBACK_APP</projectName>
    <description>Create Simple Rollback Application</description>
    <resourceName>local</resourceName>
    <tracked>0</tracked>
    <workspaceName>default</workspaceName>
    <acl>
      <inheriting>1</inheriting>
      <tracked>0</tracked>
      <aclEntry>
        <allowChangePermissions>1</allowChangePermissions>
        <allowExecute>1</allowExecute>
        <allowModify>1</allowModify>
        <allowRead>1</allowRead>
        <denyChangePermissions>0</denyChangePermissions>
        <denyExecute>0</denyExecute>
        <denyModify>0</denyModify>
        <denyRead>0</denyRead>
        <principalName>project: CO_SIMPLE_ROLLBACK_APP</principalName>
        <principalType>user</principalType>
        <tracked>0</tracked>
      </aclEntry>
    </acl>
    <propertySheet>
      <credentialProtected>0</credentialProtected>
      <tracked>0</tracked>
      <acl>
        <inheriting>1</inheriting>
        <tracked>0</tracked>
      </acl>
    </propertySheet>
    <procedure>
      <procedureName>CreateArtifact</procedureName>
      <description></description>
      <jobNameTemplate></jobNameTemplate>
      <resourceName></resourceName>
      <timeLimit></timeLimit>
      <timeLimitUnits>minutes</timeLimitUnits>
      <tracked>0</tracked>
      <workspaceName></workspaceName>
      <acl>
        <inheriting>1</inheriting>
        <tracked>0</tracked>
      </acl>
      <propertySheet>
        <credentialProtected>0</credentialProtected>
        <tracked>0</tracked>
        <acl>
          <inheriting>1</inheriting>
          <tracked>0</tracked>
        </acl>
      </propertySheet>
      <step>
        <stepName>Create Artifact</stepName>
        <alwaysRun>0</alwaysRun>
        <broadcast>0</broadcast>
        <command>#!/bin/bash&#10;&#10;echo "text for file named rollback" &gt; rollback.txt&#10; &#10;ectool createArtifact "com.ec.example" "rollback" --description "simple text file."&#10;&#10;for i in "1.0" "1.1" "2.0" "2.1" "2.2" ; do&#10;  echo "Publishing com.ec.example:rollback version $i..."&#10;  ectool --silent publishArtifactVersion \&#10;	--version $i --artifactName com.ec.example:rollback \&#10;	--fromDirectory . \&#10;	--includePatterns rollback.txt&#10;done   </command>
        <condition></condition>
        <description></description>
        <errorHandling>failProcedure</errorHandling>
        <exclusiveMode>none</exclusiveMode>
        <logFileName></logFileName>
        <parallel>0</parallel>
        <postProcessor></postProcessor>
        <precondition></precondition>
        <releaseMode>none</releaseMode>
        <resourceName></resourceName>
        <shell></shell>
        <timeLimit></timeLimit>
        <timeLimitUnits>minutes</timeLimitUnits>
        <tracked>0</tracked>
        <workingDirectory></workingDirectory>
        <workspaceName></workspaceName>
        <acl>
          <inheriting>1</inheriting>
          <tracked>0</tracked>
        </acl>
        <propertySheet>
          <credentialProtected>0</credentialProtected>
          <tracked>0</tracked>
          <acl>
            <inheriting>1</inheriting>
            <tracked>0</tracked>
          </acl>
        </propertySheet>
      </step>
    </procedure>
    <procedure>
      <procedureName>CreateRollbackApp</procedureName>
      <description></description>
      <jobNameTemplate></jobNameTemplate>
      <resourceName></resourceName>
      <timeLimit></timeLimit>
      <timeLimitUnits>minutes</timeLimitUnits>
      <tracked>0</tracked>
      <workspaceName></workspaceName>
      <acl>
        <inheriting>1</inheriting>
        <tracked>0</tracked>
      </acl>
      <propertySheet>
        <credentialProtected>0</credentialProtected>
        <tracked>0</tracked>
        <acl>
          <inheriting>1</inheriting>
          <tracked>0</tracked>
        </acl>
      </propertySheet>
      <step>
        <stepName>Create Rollback</stepName>
        <alwaysRun>0</alwaysRun>
        <broadcast>0</broadcast>
        <command>def projName = "Rollback"&#10;def appNameOne = "Rollback Application "&#10;def appTiers = [ appTierOne: "Primary Tier"]&#10;def envNames = [ "DEV", "QA", "PROD" ]&#10;def envTiers = [ envTierOne: "Tier One" ]&#10;def groupId = "com.ec.example"&#10;def resourceNameBase = ['Rollback']&#10;def artifactId = 'rollback'&#10;&#10;envNames.each { eName-&gt;&#10;	resource  projName + '-' + eName, {&#10;		description = 'local resource for the sample application'&#10;		hostName = 'localagent'&#10;		hostType = 'CONCURRENT'&#10;		port = '7800'&#10;		resourceDisabled = '0'&#10;		trusted = '0'&#10;		useSSL = '1'&#10;		zoneName = 'default'&#10;	}&#10;}&#10;&#10;// Create the project and define it's overall behavior&#10;project projName, {&#10;	description = "Project with sample applications, pipelines, releases, and accompanying objects"&#10;}&#10;&#10;// Create environments for this project&#10;project projName, {&#10;	envNames.each {eName -&gt;&#10;		environment projName + '-' + eName, {&#10;			description = 'Environment to represent ' + eName&#10;			environmentEnabled = '1'&#10;			reservationRequired = '0'&#10;			&#10;			environmentTier envTiers.envTierOne, {&#10;				resourceName = [projName + '-' + eName,]&#10;			}&#10;		}&#10;	}&#10;}&#10;&#10;//Define an application with ONE component&#10;project projName, {&#10;	application appNameOne, {&#10;		description = "Single application with a single component"&#10;		&#10;		applicationTier 'Primary Tier', {&#10;			component 'Component A', pluginName: null, {&#10;				description = 'simple text file'&#10;				pluginKey = 'EC-Artifact'&#10;				reference = '0'&#10;&#10;				process 'Deploy Component A', {&#10;					description = 'Linear deploy process'&#10;					processType = 'DEPLOY'&#10;&#10;					processStep 'Acquire Artifact',&#10;						description: 'Get the artifact from the built-in repository', &#10;						dependencyJoinType: 'and',&#10;						errorHandling: 'failProcedure',&#10;						processStepType: 'component',&#10;						subprocedure: 'Retrieve',&#10;						subproject: '/plugins/EC-Artifact/project',&#10;						actualParameter: [ &#10;							artifactName : '$' + '[/myComponent/ec_content_details/artifactName]',&#10;							artifactVersionLocationProperty : '$' + '[/myComponent/ec_content_details/artifactVersionLocationProperty]',&#10;							filterList : '$' + '[/myComponent/ec_content_details/filterList]',&#10;							overwrite : '$" + "[/myComponent/ec_content_details/overwrite]',&#10;							retrieveToDirectory : '$' + '[/myComponent/ec_content_details/retrieveToDirectory]',&#10;							versionRange : '$' + '[/myJob/ec_Component A-version]'&#10;						]&#10;					&#10;					processStep 'Transfer Artifact', {&#10;						description = 'Transfer the artifact to a destination.  TODO: Figure out the syntax to automatically pick up the filename'&#10;						dependencyJoinType = 'and'&#10;						errorHandling = 'failProcedure'&#10;						processStepType = 'command'&#10;						subprocedure = 'RunCommand'&#10;						subproject = '/plugins/EC-Core/project'&#10;						actualParameter 'commandToRun', 'echo "file transfer happens here."'&#10;					}&#10;					 processDependency 'Acquire Artifact', targetProcessStepName: 'Transfer Artifact', {&#10;						branchCondition = null&#10;						branchConditionName = null&#10;						branchConditionType = null&#10;						branchType = 'ALWAYS'&#10;					}&#10;  				}&#10;				&#10;				process 'UnDeploy Component A', {&#10;					description = 'Linear undeploy process'&#10;					processType = 'UNDEPLOY'&#10;&#10;					processStep 'Remove Artifact', {&#10;						description = 'Do something here to remove the file from the filesystem.'&#10;						dependencyJoinType = 'and'&#10;						errorHandling = 'failProcedure'&#10;						processStepType = 'command'&#10;						subprocedure = 'RunCommand'&#10;						subproject = '/plugins/EC-Core/project'&#10;						actualParameter 'commandToRun', 'echo "file transfer happens here."'&#10;					}&#10;  				}&#10;				property 'ec_content_details', {&#10;					property 'artifactName', value: groupId + ':' + artifactId, {&#10;					expandable = '1'&#10;					}&#10;					artifactVersionLocationProperty = '/myJob/retrievedArtifactVersions/$[assignedResourceName]'&#10;					filterList = ''&#10;					overwrite = 'update'&#10;					pluginProcedure = 'Retrieve'&#10;&#10;					property 'pluginProjectName', value: 'EC-Artifact', {&#10;						expandable = '1'&#10;					}&#10;				retrieveToDirectory = ''&#10;&#10;				property 'versionRange', value: '', {&#10;					expandable = '1'&#10;					}&#10;				}&#10;			}&#10;		}&#10;		&#10;		process 'Deploy App1', {&#10;			applicationName = appNameOne&#10;			processType = 'OTHER'&#10;&#10;			formalParameter 'ec_Component A-run', defaultValue: '1', {&#10;				expansionDeferred = '1'&#10;				required = '0'&#10;				type = 'checkbox'&#10;			}&#10;&#10;			formalParameter 'ec_Component A-version', defaultValue: '$' + '[/projects/Examples/applications/' + appNameOne + '/components/Component A/ec_content_details/versionRange]', {&#10;				expansionDeferred = '1'&#10;				required = '0'&#10;				type = 'entry'&#10;			}&#10;&#10;			formalParameter 'ec_enforceDependencies', defaultValue: '0', {&#10;				expansionDeferred = '1'&#10;				required = '0'&#10;				type = 'checkbox'&#10;			}&#10;&#10;			formalParameter 'ec_smartDeployOption', defaultValue: '1', {&#10;				expansionDeferred = '1'&#10;				required = '0'&#10;				type = 'checkbox'&#10;			}&#10;&#10;			formalParameter 'ec_stageArtifacts', defaultValue: '0', {&#10;				expansionDeferred = '1'&#10;				required = '0'&#10;				type = 'checkbox'&#10;			}&#10;&#10;			processStep 'Deploy A', {&#10;				applicationTierName = 'Primary Tier'&#10;				dependencyJoinType = 'and'&#10;				errorHandling = 'failProcedure'&#10;				processStepType = 'process'&#10;				subcomponent = 'Component A'&#10;				subcomponentApplicationName = appNameOne&#10;				subcomponentProcess = 'Deploy Component A'&#10;&#10;				property 'ec_deploy', {&#10;					ec_notifierStatus = '0'&#10;				}&#10;			}&#10;&#10;			property 'ec_deploy', {&#10;				ec_notifierStatus = '0'&#10;			}&#10;		}&#10;		&#10;		process 'Deploy App1 with Rollback', {&#10;			applicationName = appNameOne&#10;			processType = 'OTHER'&#10;&#10;			formalParameter 'ec_Component A-run', defaultValue: '1', {&#10;				expansionDeferred = '1'&#10;				required = '0'&#10;				type = 'checkbox'&#10;			}&#10;&#10;			formalParameter 'ec_Component A-version', defaultValue: '$'+'[/projects/Examples/applications/' + appNameOne + '/components/Component A/ec_content_details/versionRange]', {&#10;				expansionDeferred = '1'&#10;				required = '0'&#10;				type = 'entry'&#10;			}&#10;&#10;			formalParameter 'ec_enforceDependencies', defaultValue: '0', {&#10;				expansionDeferred = '1'&#10;				required = '0'&#10;				type = 'checkbox'&#10;			}&#10;&#10;			formalParameter 'ec_smartDeployOption', defaultValue: '1', {&#10;				expansionDeferred = '1'&#10;				required = '0'&#10;				type = 'checkbox'&#10;			}&#10;&#10;			formalParameter 'ec_stageArtifacts', defaultValue: '0', {&#10;				expansionDeferred = '1'&#10;				required = '0'&#10;				type = 'checkbox'&#10;			}&#10;&#10;			processStep 'Deploy A', {&#10;				applicationTierName = 'Primary Tier'&#10;				dependencyJoinType = 'and'&#10;				errorHandling = 'failProcedure'&#10;				processStepType = 'process'&#10;				subcomponent = 'Component A'&#10;				subcomponentApplicationName = appNameOne&#10;				subcomponentProcess = 'Deploy Component A'&#10;&#10;				property 'ec_deploy', {&#10;					ec_notifierStatus = '0'&#10;				}&#10;			}&#10;&#10;			processStep 'Ask to rollback', {&#10;				dependencyJoinType = 'and'&#10;				errorHandling = 'failProcedure'&#10;				instruction = 'Do you wish to rollback?'&#10;				notificationTemplate = 'ec_default_manual_process_step_notification_template'&#10;				processStepType = 'manual'&#10;				assignee = [&#10;					'admin',&#10;				]&#10;&#10;				property 'ec_deploy', {&#10;					ec_notifierStatus = '1'&#10;				}&#10;			}&#10;&#10;			processStep 'Rollback', {&#10;				dependencyJoinType = 'and'&#10;				errorHandling = 'failProcedure'&#10;				processStepType = 'rollback'&#10;				rollbackType = 'environment'&#10;				rollbackUndeployProcess = 'Undeploy App1'&#10;				smartRollback = '1'&#10;&#10;				property 'ec_deploy', {&#10;					ec_notifierStatus = '0'&#10;				}&#10;			}&#10;&#10;			processStep 'Don\'t rollback', {&#10;				applicationTierName = 'Primary Tier'&#10;				dependencyJoinType = 'and'&#10;				errorHandling = 'failProcedure'&#10;				processStepType = 'command'&#10;				subprocedure = 'RunCommand'&#10;				subproject = '/plugins/EC-Core/project'&#10;				actualParameter 'commandToRun', 'echo "No rollback needed."'&#10;&#10;				property 'ec_deploy', {&#10;					ec_notifierStatus = '0'&#10;				}&#10;			}&#10;&#10;			processDependency 'Deploy A', targetProcessStepName: 'Ask to rollback', {&#10;				branchCondition = null&#10;				branchConditionName = null&#10;				branchConditionType = null&#10;				branchType = 'ALWAYS'&#10;			}&#10;&#10;			processDependency 'Ask to rollback', targetProcessStepName: 'Rollback', {&#10;				branchCondition = null&#10;				branchConditionName = null&#10;				branchConditionType = null&#10;				branchType = 'SUCCESS'&#10;			}&#10;&#10;			processDependency 'Ask to rollback', targetProcessStepName: 'Don\'t rollback', {&#10;				branchCondition = null&#10;				branchConditionName = null&#10;				branchConditionType = null&#10;				branchType = 'ERROR'&#10;			}&#10;		  &#10;			property 'ec_deploy', {&#10;				ec_notifierStatus = '0'&#10;			}&#10;		}&#10;&#10;		process 'Undeploy App1', {&#10;			applicationName = appNameOne&#10;			processType = 'OTHER'&#10;&#10;			formalParameter 'ec_Component A-run', defaultValue: '1', {&#10;				expansionDeferred = '1'&#10;				required = '0'&#10;				type = 'checkbox'&#10;			}&#10;&#10;			formalParameter 'ec_Component A-version', defaultValue: '$'+'[/projects/Examples/applications/' + appNameOne + '/components/Component A/ec_content_details/versionRange]', {&#10;				expansionDeferred = '1'&#10;				required = '0'&#10;				type = 'entry'&#10;			}&#10;&#10;			formalParameter 'ec_enforceDependencies', defaultValue: '0', {&#10;				expansionDeferred = '1'&#10;				required = '0'&#10;				type = 'checkbox'&#10;			}&#10;&#10;			formalParameter 'ec_smartDeployOption', defaultValue: '1', {&#10;				expansionDeferred = '1'&#10;				required = '0'&#10;				type = 'checkbox'&#10;			}&#10;&#10;			formalParameter 'ec_stageArtifacts', defaultValue: '0', {&#10;				expansionDeferred = '1'&#10;				required = '0'&#10;				type = 'checkbox'&#10;			}&#10;&#10;			processStep 'UnDeploy A', {&#10;				applicationTierName = 'Primary Tier'&#10;				dependencyJoinType = 'and'&#10;				errorHandling = 'failProcedure'&#10;				processStepType = 'process'&#10;				subcomponent = 'Component A'&#10;				subcomponentApplicationName = appNameOne&#10;				subcomponentProcess = 'UnDeploy Component A'&#10;&#10;				property 'ec_deploy', {&#10;					ec_notifierStatus = '0'&#10;				}&#10;			}&#10;&#10;			property 'ec_deploy', {&#10;				ec_notifierStatus = '0'&#10;			}&#10;		}&#10;&#10;		envNames.each { eName-&gt;&#10;			tierMap projName + '-' +  eName, {&#10;				applicationName = appNameOne&#10;				environmentName = projName + '-' + eName				&#10;				environmentProjectName = projName&#10;				projectName = projName&#10;&#10;				tierMapping projName + '-' + envTiers.envTierOne + '-' + eName, {&#10;					applicationTierName = appTiers.appTierOne&#10;					environmentTierName = envTiers.envTierOne&#10;				}	&#10;			}&#10;		}&#10;		property 'ec_deploy', {&#10;			ec_notifierStatus = '0'&#10;		}&#10;	}&#10;}</command>
        <condition></condition>
        <description></description>
        <errorHandling>failProcedure</errorHandling>
        <exclusiveMode>none</exclusiveMode>
        <logFileName></logFileName>
        <parallel>0</parallel>
        <postProcessor></postProcessor>
        <precondition></precondition>
        <releaseMode>none</releaseMode>
        <resourceName></resourceName>
        <shell>ectool evalDsl --dslFile {0}</shell>
        <timeLimit></timeLimit>
        <timeLimitUnits>minutes</timeLimitUnits>
        <tracked>0</tracked>
        <workingDirectory></workingDirectory>
        <workspaceName></workspaceName>
        <acl>
          <inheriting>1</inheriting>
          <tracked>0</tracked>
        </acl>
        <propertySheet>
          <credentialProtected>0</credentialProtected>
          <tracked>0</tracked>
          <acl>
            <inheriting>1</inheriting>
            <tracked>0</tracked>
          </acl>
        </propertySheet>
      </step>
    </procedure>
  </project>
</exportedData>
